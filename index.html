<!DOCTYPE html><script>"use strict";let frame={start:performance.now(),delta:0};function setLangPrefs(){switch(window.navigator.language.substring(0,2).toUpperCase()){case"EN":default:break;case"RU":document.getElementsByTagName("title")[0].innerHTML="ПРОГОРКЛЫЕ-ПТИЦЫ"}}let camera={x:0,y:0,z:-20,yaw:0,pitch:0,roll:0,yawShiftS:0,yawShiftC:1,fov:90,screenDistance:window.innerWidth/2,renderDistance:300},object=[["#ffaa00",{x:-10,y:-10,z:10},{x:10,y:-10,z:10},{x:10,y:10,z:10},{x:-10,y:10,z:10}]],cube=[["#000000",{x:-10,y:-10,z:30},{x:10,y:-10,z:30},{x:10,y:10,z:30},{x:-10,y:10,z:30}],["#ff0000",{x:10,y:-10,z:10},{x:10,y:10,z:10},{x:10,y:10,z:30},{x:10,y:-10,z:30}],["#00ff00",{x:-10,y:-10,z:10},{x:-10,y:10,z:10},{x:-10,y:10,z:30},{x:-10,y:-10,z:30}],["#0000ff",{x:-10,y:10,z:10},{x:10,y:10,z:10},{x:10,y:10,z:30},{x:-10,y:10,z:30}],["#ffff00",{x:-10,y:-10,z:10},{x:10,y:-10,z:10},{x:10,y:-10,z:30},{x:-10,y:-10,z:30}],["#ff00ff",{x:-10,y:-10,z:10},{x:10,y:-10,z:10},{x:10,y:10,z:10},{x:-10,y:10,z:10}]];function scenify(e,t,n){let a,i,r,o,l,c,d,s,y,f,h,m,u,w,g,v,x,p,z=[];const k=e.canvas.width/2,S=e.canvas.height/2;for(let e=0;e<n.length;e++){m=n[e].transform,o=m.x,l=m.y,c=m.z,m=n[e].model;for(let e=0;e<m.length;e++){u=[m[e][0]],w=m[e].length-1,g=w;for(let n=1;n<m[e].length;n++)f=m[e][n],a=f.x+o-t.x,i=f.y+l-t.y,r=f.z+c-t.z,d=a*a+i*i+r*r,s=r*t.yawShiftS+a*t.yawShiftC,y=r*t.yawShiftC-a*t.yawShiftS,a=s,r=y,Math.pow(t.renderDistance,2)<=d&&w--,r=t.screenDistance/r,a*=r,i*=r,Math.abs(a)>k+2&&Math.abs(i)>S+2&&g--,r<=0&&(i*=-1,a*=-1),u.push([Math.floor(k+a),Math.floor(S-i),d]);for(let t=1;t<m[e].length;t++){v=u[t],h=0;for(let t=1;t<m[e].length;t++)u[t][0]==v[0]&&u[t][1]==v[1]&&h++;if(1!=h){w=-1,g=-1;break}}x=0,p=0;for(let e=1;e<u.length;e++)x+=u[e][2],p++;u[1][2]=x/p,w>0&&g>0&&z.push(u)}}return z=z.sort((function(e,t){return t[1][2]-e[1][2]})),z}function scenifyTriangle(e,t,n){let a,i,r,o,l,c,d,s,y,f,h,m,u,w,g,v,x,p,z=[];const k=e.canvas.width/2,S=e.canvas.height/2;for(let e=0;e<n.length;e++){m=n[e].transform,o=m.x,l=m.y,c=m.z,m=n[e].model;for(let e=0;e<m.length;e++){u=[m[e][0]],w=3,g=w;for(let n=1;n<4;n++)f=m[e][n],a=f.x+o-t.x,i=f.y+l-t.y,r=f.z+c-t.z,d=a*a+i*i+r*r,s=r*t.yawShiftS+a*t.yawShiftC,y=r*t.yawShiftC-a*t.yawShiftS,a=s,r=y,Math.pow(t.renderDistance,2)<=d&&w--,r=t.screenDistance/r,a*=r,i*=r,Math.abs(a)>k+2&&Math.abs(i)>S+2&&g--,r<=0&&(i*=-1,a*=-1),u.push([Math.floor(k+a),Math.floor(S-i),d]);for(let e=1;e<4;e++){v=u[e],h=0;for(let e=1;e<4;e++)u[e][0]==v[0]&&u[e][1]==v[1]&&h++;if(1!=h){w=-1,g=-1;break}}x=0,p=0;for(let e=1;e<4;e++)x+=u[e][2],p++;u[1][2]=x/p,w>0&&g>0&&z.push(u)}}return z=z.sort((function(e,t){return t[1][2]-e[1][2]})),z}let talking=0;function draw(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.beginPath(),e.fillStyle="#ffffff",e.rect(0,0,e.canvas.width,e.canvas.height),e.fill(),polyBatch(e,t),keyDown(" ")?talking+=frame.delta/8:talking-=frame.delta/8,talking>20&&(talking=20),talking<0&&(talking=0),document.getElementsByTagName("div")[0].style=0==talking?`${divStyle}display:none;`:`${divStyle}height:${talking}vh;`}function polyBatch(e,t){for(let n=0;n<t.length;n++)if(t[n].length>=4){e.beginPath(),e.moveTo(t[n][1][0],t[n][1][1]);for(let a=2;a<t[n].length;a++)e.lineTo(t[n][a][0],t[n][a][1]);e.fillStyle=t[n][0],e.fill()}}function triangleBatchPixel(e,t){let n,a=e.canvas.width,i=e.canvas.height,r=e.createImageData(a,i);for(let e=0;e<t.length;e++){n=t[e][0].split("").map(((e,t,n)=>n[t]+(n[t+1]??""))).slice(0,-1);for(let e=0;e<3;e++)n[e]=parseInt(n[e],16);n.push(255)}e.putImageData(r,0,0)}function run(e){frame.delta=performance.now()-frame.start,frame.start+=frame.delta,e.call(),window.requestAnimationFrame(run.bind(null,e))}function frameR(e){processInput(),draw(e,scenify(e,camera,[{model:cube,transform:{x:0,y:0,z:0,yaw:0,pitch:0,roll:0}}]))}document.addEventListener("mousemove",mouseMoved),document.addEventListener("keydown",keyPressed,!1),document.addEventListener("keyup",keyReleased,!1);let keyArray=[],acceptedKeys=["w","a","s","d"," "];function keyPressed(e){let t=e.key.toString().toLowerCase();!keyArray.includes(t)&&acceptedKeys.includes(t)&&keyArray.push(t)}function keyReleased(e){let t=e.key.toString().toLowerCase();keyArray.includes(t)&&keyArray.splice(keyArray.indexOf(t),1)}function mouseMoved(e){camera.yaw-=e.movementX/3,camera.yaw%=360;let t=camera.yaw/57.2957;camera.yawShiftS=Math.sin(t),camera.yawShiftC=Math.cos(t)}function keyDown(e){return keyArray.includes(e)}function processInput(){keyDown("w")&&move2d(1,0),keyDown("a")&&move2d(1,270),keyDown("s")&&move2d(1,180),keyDown("d")&&move2d(1,90)}function move2d(e,t){let n=(t-camera.yaw)%360/57.2957,a=e*frame.delta/14;camera.z+=Math.cos(n)*a,camera.x+=Math.sin(n)*a}function refreshFVSD(){camera.screenDistance=Math.round(1/(Math.tan(camera.fov/114.5915)/(window.innerWidth/2)))}window.addEventListener("resize",(function(){let e=document.getElementById("canvas");e.height=window.innerHeight,e.width=window.innerWidth,refreshFVSD()}));let divStyle="background-color:black;color:white;position:fixed;top:70vh;right:10vw;width:80vw;",normalStyle="overflow:hidden;margin:0;padding:0;image-rendering:pixelated;image-rendering:crisp-edges;";window.onload=function(){let e=document.createElement("title");e.innerHTML="RANCID BIRDS",document.getElementsByTagName("head")[0].appendChild(e),setLangPrefs(),document.body.innerHTML=`<canvas id="canvas"></canvas><div style="${divStyle}"></div>`,e=document.createElement("style"),e.innerHTML=`html,body,canvas{${normalStyle}}`,document.getElementsByTagName("head")[0].appendChild(e);let t=document.getElementById("canvas");t.height=window.innerHeight,t.width=window.innerWidth;let n=t.getContext("2d",{alpha:!1});run(frameR.bind(null,n));let a=document.body;a.addEventListener("click",(async()=>{a.requestPointerLock({unadjustedMovement:!0})}))};</script>