<!DOCTYPE html><script>"use strict";let frame={start:performance.now(),delta:0},cube=[["#ffffff",{x:-10,y:-10,z:30},{x:10,y:-10,z:30},{x:10,y:10,z:30}],["#ffffff",{x:-10,y:-10,z:30},{x:-10,y:10,z:30},{x:10,y:10,z:30}],["#ff0000",{x:10,y:-10,z:10},{x:10,y:10,z:10},{x:10,y:10,z:30}],["#ff0000",{x:10,y:-10,z:10},{x:10,y:-10,z:30},{x:10,y:10,z:30}],["#00ff00",{x:-10,y:-10,z:10},{x:-10,y:10,z:10},{x:-10,y:10,z:30}],["#00ff00",{x:-10,y:-10,z:10},{x:-10,y:-10,z:30},{x:-10,y:10,z:30}],["#0000ff",{x:-10,y:10,z:10},{x:10,y:10,z:10},{x:10,y:10,z:30}],["#0000ff",{x:-10,y:10,z:10},{x:-10,y:10,z:30},{x:10,y:10,z:30}],["#ffff00",{x:-10,y:-10,z:10},{x:10,y:-10,z:10},{x:10,y:-10,z:30}],["#ffff00",{x:-10,y:-10,z:10},{x:-10,y:-10,z:30},{x:10,y:-10,z:30}],["#ff00ff",{x:-10,y:-10,z:10},{x:10,y:-10,z:10},{x:10,y:10,z:10}],["#ff00ff",{x:-10,y:-10,z:10},{x:-10,y:10,z:10},{x:10,y:10,z:10}]],camera={x:0,y:0,z:-20,yaw:0,pitch:0,roll:0,yawShiftS:0,yawShiftC:1,fov:90,screenDistance:240,renderDistance:300};function run(e){frame.delta=performance.now()-frame.start,frame.start+=frame.delta,e.call(),window.requestAnimationFrame(run.bind(null,e))}function frameR(e){processInput(),draw(e,scenifyTriangle(e,camera,[{model:cube,transform:{x:0,y:0,z:0,yaw:0,pitch:0,roll:0}},{model:cube,transform:{x:10,y:10,z:10,yaw:0,pitch:0,roll:0}}]))}document.addEventListener("mousemove",mouseMoved),document.addEventListener("keydown",keyPressed,!1),document.addEventListener("keyup",keyReleased,!1);let keyArray=[],acceptedKeys=["w","a","s","d"," "];function keyPressed(e){let t=e.key.toString().toLowerCase();!keyArray.includes(t)&&acceptedKeys.includes(t)&&keyArray.push(t)}function keyReleased(e){let t=e.key.toString().toLowerCase();keyArray.includes(t)&&keyArray.splice(keyArray.indexOf(t),1)}function mouseMoved(e){camera.yaw-=e.movementX/3,camera.yaw%=360;let t=camera.yaw/57.2957;camera.yawShiftS=Math.sin(t),camera.yawShiftC=Math.cos(t)}function keyDown(e){return keyArray.includes(e)}function processInput(){keyDown("w")&&move2d(1,0),keyDown("a")&&move2d(1,270),keyDown("s")&&move2d(1,180),keyDown("d")&&move2d(1,90)}function move2d(e,t){let a=(t-camera.yaw)%360/57.2957,n=e*frame.delta/14;camera.z+=Math.cos(a)*n,camera.x+=Math.sin(a)*n}function refreshFVSD(){camera.screenDistance=Math.round(1/(Math.tan(camera.fov/114.5915)/240))}function scenify(e,t,a){let n,r,l,o,i,f,c,y,s,h,d,m,u,g,w,x,z,v,p=[];const k=e.canvas.width/2,M=e.canvas.height/2;for(let e=0;e<a.length;e++){m=a[e].transform,o=m.x,i=m.y,f=m.z,m=a[e].model;for(let e=0;e<m.length;e++){u=[m[e][0]],g=m[e].length-1,w=g;for(let a=1;a<m[e].length;a++)h=m[e][a],n=h.x+o-t.x,r=h.y+i-t.y,l=h.z+f-t.z,y=l*t.yawShiftS+n*t.yawShiftC,s=l*t.yawShiftC-n*t.yawShiftS,n=y,l=s,c=Math.pow(n,2)+Math.pow(r,2)+Math.pow(l,2),Math.pow(t.renderDistance,2)<=c&&g--,l=t.screenDistance/l,n*=l,r*=l,Math.abs(n)>k+2&&Math.abs(r)>M+2&&w--,l<=0&&(r*=-1,n*=-1),u.push([Math.floor(k+n),Math.floor(M-r),Math.sqrt(c)]);for(let t=1;t<m[e].length;t++){x=u[t],d=0;for(let t=1;t<m[e].length;t++)u[t][0]==x[0]&&u[t][1]==x[1]&&d++;if(1!=d){g=-1,w=-1;break}}z=0,v=0;for(let e=1;e<u.length;e++)z+=u[e][2],v++;u[1][2]=z/v,g>0&&w>0&&p.push(u)}}return p=p.sort((function(e,t){return t[1][2]-e[1][2]})),p}let talking=0;function draw(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.beginPath(),e.fillStyle="#ffffff",e.rect(0,0,e.canvas.width,e.canvas.height),e.fill(),triangleBatchPixel(e,t,camera),keyDown(" ")?talking+=frame.delta/8:talking-=frame.delta/8,talking>20&&(talking=20),talking<0&&(talking=0),document.getElementsByTagName("div")[0].style=0==talking?`${divStyle}display:none;`:`${divStyle}height:${talking}vh;`}function polyBatch(e,t){for(let a=0;a<t.length;a++)if(t[a].length>=4){e.beginPath(),e.moveTo(t[a][1][0],t[a][1][1]);for(let n=2;n<t[a].length;n++)e.lineTo(t[a][n][0],t[a][n][1]);e.fillStyle=t[a][0],e.fill()}}function triangleBatchPixel(e,t,a){let n,r,l,o=e.canvas.width,i=e.canvas.height,f=new Uint8ClampedArray(i*o*4),c=new Array(i*o);for(let y=0;y<t.length;y++){n=[],n.length=0,n=t[y][0].substring(1).split(/(..)/g).filter((e=>e));for(let z=0;z<3;z++)n[z]=parseInt(n[z],16);n.length=3,n.push(255),r=[];for(let v=1;v<4;v++)r.push(t[y][v]);let s,h,d,m,u,g,w;function x(e,t,a){let r=a[0][0]*(a[2][1]-a[1][1])+a[1][0]*(a[0][1]-a[2][1])+a[2][0]*(a[1][1]-a[0][1]);l=t*(a[2][1]-a[1][1])+a[1][0]*(e-a[2][1])+a[2][0]*(a[1][1]-e),l/=r;let i=l;l=-(t*(a[2][1]-a[0][1])+a[0][0]*(e-a[2][1])+a[2][0]*(a[0][1]-e)),l/=r;let y=l,s=1-i-y,h=(i*a[0][2]+y*a[1][2]+s*a[2][2])/3;if(l=h,w=4*(o*e+t),w>=0&&w<f.length&&t%o==t&&t>=0&&(c[w/4]>l||null==c[w/4])){c[w/4]=l;for(let e=0;e<3;e++)f[w+e]=n[e];f[w+3]=255}}if(r=r.sort((function(e,t){return e[1]-t[1]})),r[2][1]!=r[1][1]){s=r,h=(s[2][0]-s[0][0])/(s[2][1]-s[0][1]),d=(s[2][0]-s[1][0])/(s[2][1]-s[1][1]),m=!1,m=!(h<d),u=s[2][0],g=u;for(let p=s[2][1];p>s[1][1];p--){if(m)for(let k=Math.floor(u);k<=Math.ceil(g);k++)x(p,k,r);else for(let M=Math.floor(g);M<=Math.ceil(u);M++)x(p,M,r);p>i&&(u-=(p-i-1)*h,g-=(p-i-1)*d,p=i+1),u-=h,g-=d}}if(r[0][1]!=r[1][1]){s=r,h=(s[1][0]-s[0][0])/(s[1][1]-s[0][1]),d=(s[2][0]-s[0][0])/(s[2][1]-s[0][1]),m=!1,m=h<d,u=s[0][0],g=u;for(let S=s[0][1];S<=s[1][1];S++){if(m)for(let b=Math.floor(u);b<=Math.ceil(g);b++)x(S,b,r);else for(let D=Math.floor(g);D<=Math.ceil(u);D++)x(S,D,r);S<0&&(u+=(0-S-1)*h,g+=(0-S-1)*d,S=-1),u+=h,g+=d}}}e.putImageData(new ImageData(f,o),0,0)}function scenifyTriangle(e,t,a){let n,r,l,o,i,f,c,y,s,h,d,m,u,g,w,x,z=[];const v=e.canvas.width/2,p=e.canvas.height/2;for(let e=0;e<a.length;e++){m=a[e].transform,o=m.x,i=m.y,f=m.z,m=a[e].model;for(let e=0;e<m.length;e++){u=[m[e][0]],g=3,w=g;for(let a=1;a<4;a++)h=m[e][a],n=h.x+o-t.x,r=h.y+i-t.y,l=h.z+f-t.z,y=l*t.yawShiftS+n*t.yawShiftC,s=l*t.yawShiftC-n*t.yawShiftS,n=y,l=s,c=n*n+r*r+l*l,Math.pow(t.renderDistance,2)<=c&&g--,l=t.screenDistance/l,n*=l,r*=l,Math.abs(n)>v+2&&Math.abs(r)>p+2&&w--,l<=0&&(r*=-1,n*=-1),u.push([Math.floor(v+n),Math.floor(p-r),Math.sqrt(c),s]);for(let e=1;e<4;e++){x=u[e],d=0;for(let e=1;e<4;e++)u[e][0]==x[0]&&u[e][1]==x[1]&&d++;if(1!=d){g=-1,w=-1;break}}g>0&&w>0&&z.push(u)}}return z=z.sort((function(e,t){return t[1][2]-e[1][2]})),z}function setLangPrefs(){switch(window.navigator.language.substring(0,2).toUpperCase()){case"EN":default:break;case"RU":document.getElementsByTagName("title")[0].innerHTML="ПРОГОРКЛЫЕ-ПТИЦЫ"}}let object=[["#ffaa00",{x:-10,y:-10,z:10},{x:10,y:-10,z:10},{x:10,y:10,z:10},{x:-10,y:10,z:10}]];window.addEventListener("resize",(function(){let e=document.getElementById("canvas");e.height=270,e.width=480,refreshFVSD()}));let divStyle="background-color:black;color:white;position:fixed;top:70vh;right:10vw;width:80vw;",normalStyle="overflow:hidden;margin:0;padding:0;image-rendering:pixelated;image-rendering:crisp-edges;height:100vh;width:100vw;";window.onload=function(){let e=document.body;e.addEventListener("click",(async()=>{e.requestPointerLock({unadjustedMovement:!0})}));let t=document.createElement("title");t.innerHTML="RANCID BIRDS",document.getElementsByTagName("head")[0].appendChild(t),setLangPrefs(),document.body.innerHTML=`<canvas id="canvas"></canvas><div style="${divStyle}"></div>`,t=document.createElement("style"),t.innerHTML=`html,body,canvas{${normalStyle}}`,document.getElementsByTagName("head")[0].appendChild(t);let a=document.getElementById("canvas");a.height=270,a.width=480;let n=a.getContext("2d",{alpha:!1});run(frameR.bind(null,n))};</script>